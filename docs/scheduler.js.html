<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: scheduler.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: scheduler.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Queue, Worker, connection } from "./bullmq.config.js";

/**
 * Initialize a tenant's queue.
 *
 * @param {string} tenantId - The ID of the tenant.
 * @param {string} queueName - The name of the scheduler (queue).
 * @returns {Queue} - The created BullMQ queue.
 */
export const initializeTenantQueue = (tenantId, queueName) => {
  const queuName = `${tenantId}-${queueName}`;

  const taskQueue = new Queue(queuName, { connection });

  // Create a worker to process jobs
  const worker = new Worker(
    queuName,
    async (job) => {
      // Define job processing logic here
      console.log(
        `Processing job ${job.id} in queue ${queuName} for tenant ${tenantId}`
      );
      // Simulate task execution (replace with actual task logic)
      await new Promise((resolve) => setTimeout(resolve, 1000));
      console.log(`Job completed for tenant ${tenantId}:`, job.id);
    },
    { connection }
  );

  worker.on("completed", (job) => {
    console.log(`${job.id} has completed!`);
  });

  worker.on("failed", (job, err) => {
    console.log(`${job.id} has failed with ${err.message}`);
  });

  return taskQueue;
};

/**
 * Pause a BullMQ queue.
 *
 * @param {Queue} queue - The BullMQ queue to pause.
 * @returns {Promise&lt;void>}
 */
export const pauseQueue = async (queue) => {
  await queue.pause();
};

/**
 * Resume a BullMQ queue.
 *
 * @param {Queue} queue - The BullMQ queue to resume.
 * @returns {Promise&lt;void>}
 */
export const resumeQueue = async (queue) => {
  await queue.resume();
};

/**
 * Delete a BullMQ queue.
 *
 * @param {Queue} queue - The BullMQ queue to delete.
 * @returns {Promise&lt;void>}
 */
export const deleteQueue = async (queue) => {
  await queue.close();
  await queue.remove();
};

/**
 * Get all jobs from a BullMQ queue.
 *
 * @param {Queue} queue - The BullMQ queue to retrieve jobs from.
 * @returns {Promise&lt;Array>} - The list of jobs in the queue.
 */
export const getQueueJobs = async (queue) => {
  return await queue.getJobs();
};

// Additional functions related to job management can go here...
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#createScheduler">createScheduler</a></li><li><a href="global.html#deleteQueue">deleteQueue</a></li><li><a href="global.html#getQueueJobs">getQueueJobs</a></li><li><a href="global.html#getScheduler">getScheduler</a></li><li><a href="global.html#initializeTenantQueue">initializeTenantQueue</a></li><li><a href="global.html#listSchedulers">listSchedulers</a></li><li><a href="global.html#pauseQueue">pauseQueue</a></li><li><a href="global.html#resumeQueue">resumeQueue</a></li><li><a href="global.html#updateScheduler">updateScheduler</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Sun Aug 18 2024 14:25:08 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
